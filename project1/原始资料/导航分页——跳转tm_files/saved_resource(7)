KISSY.add("shop/head/main/index",function(e,t,a){return{"initView":function(e,a,i,n){var r=this;codeTrack("head.main.init"),a=a||{};var s=t.get("#mallSearch");s&&i.addElement(s,"shop/head/search/",a);var o=t.get("#shop-info");if(o&&i.addElement(o,"shop/head/shopinfo/",{"isInitDialog":a.isInitDialog,"onLogin":a.onLogin,"onToken":a.onToken,"onData":a.onShopData}),!1!==a.showQrcode&&(a.wtId||a.shopId||a.sellerId)){var l=t.create('<div class="shopwt"></div>'),d=t.get("#shopExtra")||t.get("#mallLogo")||t.get(".tbsSiteInfo");d&&(t.insertAfter(l,d),i.addElement(l,"shop/head/qrcode/",{"shopId":a.shopId,"sellerId":a.sellerId,"wtId":a.wtId}))}n(r)}}},{"requires":["dom","event","shop/head/search/","shop/head/shopinfo/","shop/head/qrcode/","shop/head/main/index.css"]});
KISSY.add("shop/head/search/index",function(e,t,a,i,n){var r,s,o,l;return{"init":function(e){var a,i=this;codeTrack("head.search.init"),l=e,r=l.el,s=t.get("#mq",r),o=s.form,(l.suggestControl||function(e){e()})(function(){(a=i.getNID())&&n.build({"node":"#mq","inShopAction":i.getShopUrl()||"","inShopBtn":"#J_CurrShopBtn","autoFocus":!0,"nid":a,"time":e.time})})},"getShopUrl":function(){return l.shopUrl||t.get("#J_ShopSearchUrl")&&t.get("#J_ShopSearchUrl").value},"getNID":function(){return l.itemId?l.itemId:l.shop_config&&l.shop_config.isvStat?l.shop_config.isvStat.userId:""},"initView":function(t,a,i,n){var r=this;r.init(e.mix({"el":t},a)),n(r)}}},{"requires":["dom","event","ajax","mui/searchbar/instance/detail"]});
KISSY.add("shop/head/shopinfo/index",function(e,t,a,i,n,r){function s(t){var i="SM_368_dsr-"+a.val("#dsr-userid");e.io({"url":a.val("#dsr-url"),"dataType":"jsonp","data":{"keys":i},"cache":"false","complete":function(e){t(e&&e[i])}})}var o,l=-1==e.version.indexOf("1.3"),d=function(t,i){var r=document;return function(){var s=t.get("#popupPanel"),d=-1!==location.hostname.indexOf("tmall.com")||-1!==location.hostname.indexOf("tmall.net");s||(s=t.create('<div id="popupPanel"></div>'),l&&(a.addClass(s,"ks-dialog-focused"),a.addClass(s,"ks-overlay-focused"),s.innerHTML='<div class="ks-dialog-content"><div class="ks-dialog-header" style="display: none"></div><div class="ks-dialog-body"></div></div></div>'),r.body.appendChild(s));var c=t.get(".J_TDialogTrigger",o),p=c.getAttribute("data-width"),u=c.getAttribute("data-height"),m=new n.Dialog({"srcNode":s,"width":p,"height":u,"closable":!1,"elStyle":{"display":"block","visibility":"hidden","position":"absolute","left":"-9999px","top":"-9999px"},"zIndex":1e8});i.on(c,"click",function(e){e.preventDefault(),a.show(s),m.hide(),m.show(),a.show(s)}),m.on("show",function(){var n=this,r=c.href+(d?"&isTmall=1":"")+"&t="+ +new Date,o='<a class="close-btn" href="javascript:void(0)"style="position: absolute; top: 5px; right: 4px; outline: none;display: block; width: 15px; height: 15px; background: url(//assets.alicdn.com/app/tc/img/close_btn.png) no-repeat; text-decoration: none; text-indent: -99999px">X</a><iframe src="'+r+'" width="'+p+'" height="'+u+'" name="popupIframe" frameborder="0" scrolling="no"></iframe>';n.set("width",p),n.set("height",u),-1==e.version.indexOf("1.3")?n.set("bodyContent",o):s.innerHTML=o,m.center(),i.on(t.get(".close-btn",s),"click",function(){a.hide(s),m.hide()}),t.hasClass(c,"collection")&&((new Image).src="//www.atpanel.com/jsclick?cache="+ +new Date+"&auc_detail=b_collect_item"),t.removeClass("#shop-info","expanded")})}}(a,i);return{"onData":s,"init":function(r){function l(e){if(r.isTwView)return e(null);(r.onData||s)(function(t){if(null===t&&r.onData!=s)return s(e);e(t)})}function c(e){var t=a.get("textarea.ks-datalazyload",o);if(!t)return e();p.onDatalazyload(function(a){a.textareaHandle.apply(t),e()})}var p=this;codeTrack("head.shopinfo.init"),r=r||{},o=r.isTwView?a.get("#J_HdShopInfo"):a.get("#shop-info");var u,m=function(i){var r=a.get(".extra-info",o);if(-1==e.version.indexOf("1.3")){var s=a.create('<div class="ks-popup-content"></div>'),l=[];e.each(r.childNodes,function(e){l.push(e)}),e.each(l,function(e){s.appendChild(e)}),r.appendChild(s)}var d=a.get("#shopExtra"),c=a.get("#j_ExtraInfoHd",r)?430:a.width(d);new n.Popup({"srcNode":r,"trigger":d,"triggerType":"mouse","width":c,"zIndex":1e5,"align":{"node":d,"points":["bc","tc"],"offset":[0,1]}}).show(),a.css(r,{"width":c,"zIndex":1e5});var p=a.get("#J_DrugCert");if(!p)return i(null);var u=a.attr(p,"data-url");t({"url":u,"type":"get","dataType":"jsonp","success":function(e){if(!e)return i(null);e.hasDrugSupply&&a.show(a.get(".J_DrugSupply",p)),e.hasDrugQualityManage&&a.show(a.get(".J_DrugQualityManage",p)),e.hasDrugInfoService&&a.show(a.get(".J_DrugInfoService",p)),a.show(p),i(null)}})},v=p.createLoader(function(t){c(function(){a.get(".j_CollectBrand",o)&&(codeTrack("head.shopinfo.brandshow","head.shopinfo.init"),KISSY.config({"packages":{"mui/brandbar":{"debug":!0,"ignorePackageNameInUri":!0,"version":"3.0.7","path":"//g.alicdn.com/mui/brandbar/3.0.7/"},"mui/tbuser":{"debug":!0,"ignorePackageNameInUri":!0,"version":"3.0.4","path":"//g.alicdn.com/mui/tbuser/3.0.4/"}}}),e.use("mui/brandbar/brandbar",function(e,t){t.bindEl(".tm-collectBtn",{"onLogin":r.onLogin,"onToken":r.onToken,"success":function(){codeTrack("head.shopinfo.brandsuccess","head.shopinfo.brandclick")},"error":function(){codeTrack("head.shopinfo.branderror","head.shopinfo.brandclick")}})})),window.Light&&window.Light.light(o),l(function(i){return i&&e.isObject(i)?(e.use("shop/head/shopinfo/index.tpl,shop/head/shopinfo/dsr.tpl",function(e,t,n){var r=[{"rate":(Math.floor(10*i.m)/10).toFixed(1),"rate_title":i.m,"rate_UFB":i.m_UFB,"rate_g":i.m_g},{"rate":(Math.floor(10*i.s)/10).toFixed(1),"rate_title":i.s,"rate_UFB":i.s_UFB,"rate_g":i.s_g},{"rate":(Math.floor(10*i.c)/10).toFixed(1),"rate_title":i.c,"rate_UFB":i.c_UFB,"rate_g":i.c_g}];codeTrack("head.shopinfo.tpl","head.shopinfo.init"),a.html(a.get(".main-info",o),t({"rates":r})),a.html(a.get(".shop-rate",o),n({"rate_link":a.val("#dsr-ratelink"),"rates":r,"isInternational":window.g_config.isInternational}))}),m(t)):m(t)})})});i.on(o,"mouseenter",function(){u&&clearTimeout(u),u=setTimeout(function(){v(function(){a.addClass(o,"expanded")})},100)}),i.on(o,"mouseleave",function(){u&&clearTimeout(u),u=setTimeout(function(){v(function(){a.removeClass(o,"expanded")},0)},100)}),!1!==r.isInitDialog&&v(function(){d()},0)},"initView":function(t,a,i,n){var r=this;r.createLoader=i.createLoader,r.onDatalazyload=i.onDatalazyload,r.init(e.mix({"el":t},a)),n(r)}}},{"requires":["io","dom","event","overlay","shop/head/shopinfo/index.css","shop/head/shopinfo/index.tpl","shop/head/shopinfo/dsr.tpl"]});
KISSY.add("shop/head/qrcode/index",function(e,t,a,i){return{"init":function(e){codeTrack("head.qrcode.init");var n,r=e.el,s=e.shopId,o=!1;if(s&&r){t.html(r,i());var l=r,d=t.get(".tm-qrcode-hpic",r);a.on(l,"mouseover",function(){n&&clearTimeout(n),n=setTimeout(function(){if(t.show(d),t.addClass(r,"expanded"),!o){o=!0;var e=encodeURIComponent("http://m.laiwang.com/market/laiwang/tmall/app-download.php?&type=shop&biz=tmall&iframe=1&mmstat=shop_head&key="+s),a="//gcodex.alicdn.com/qrcode.do?biz_code=tmallpc&content="+e+"&size=175&margin=0&logo_url="+encodeURIComponent("http://img.alicdn.com/tfs/TB1prMSRXXXXXcCXFXXXXXXXXXX-198-198.png")+"&channel_id=2703";t.get("img",d).src=a,codeTrack("head.qrcode.load")}},100)}),a.on(l,"mouseout",function(){n&&clearTimeout(n),n=setTimeout(function(){t.hide(d),t.removeClass(r,"expanded")},100)})}},"initView":function(t,a,i,n){var r=this;r.init(e.mix({"el":t},a)),n(r)}}},{"requires":["dom","event","shop/head/qrcode/index.tpl","shop/head/qrcode/index.css"]});
KISSY.add("shop/head/qrcode/index.tpl",function(a,e){var t,s=function(a){var e=this,t=e.root,s=e.buffer,r=e.scope,i=(e.runtime,e.name,e.pos,r.data,r.affix,t.nativeCommands),l=t.utils;l.callFn,l.callDataFn,l.callCommand,i.range,i["void"],i.foreach,i.forin,i.each,i["with"],i["if"],i.set,i.include,i.parse,i.extend,i.block,i.macro,i["debugger"];return s.data+='<div class="shopwt-desc"><div class="shopwt-title">\u624b\u673a\u901b</div><i class="shopwt-qr">&#xe602;</i></div><a class="slogo-triangle"><i class="icon-triangle"></i></a><div class="tm-qrcode-hpic"><img width="140"><p class="J_QrcodeHeadText">\u626b\u4e00\u626b\uff0c\u624b\u673a\u901b\u8d77\u6765</p></div>',s};return function(a){return(t=t||new e(s))&&t.render(a)||""}},{"requires":["kg/xtemplate/4.3.0/runtime"]});
KISSY.add("shop/head/shopinfo/index.tpl",function(a,e){var t,r=function(a){function e(a,e,t){a.data,a.affix;return e.data+="\u63cf \u8ff0",e}function t(a,e,t){a.data,a.affix;return e.data+="\u670d \u52a1",e}function r(a,e,t){a.data,a.affix;return e.data+="\u7269 \u6d41",e}function s(a,e,s){var n=a.data,i=a.affix;e.data+="";var l=(f=i.xindex)!==s?f:(f=n.xindex)!==s?f:a.resolveLooseUp(["xindex"]),o=l;return o=1===l,e=_.call(m,a,{"params":[o],"fn":t,"inverse":r},e),e.data+="",e}function n(a,e,t){a.data,a.affix;return e.data+="shopdsr-score-up-ctrl",e}function i(a,e,t){a.data,a.affix;return e.data+="shopdsr-score-down-ctrl",e}function l(a,e,t){a.data,a.affix;return e.data+="shopdsr-score-equal-ctrl",e}function o(a,e,t){var r=a.data,s=a.affix;e.data+="";var n=(f=s.rate_UFB)!==t?f:(f=r.rate_UFB)!==t?f:a.resolveLooseUp(["rate_UFB"]),o=n;return o=2===n,e=_.call(m,a,{"params":[o],"fn":i,"inverse":l},e),e.data+="",e}function d(a,e,t){a.data,a.affix;return e.data+='<s class="shopdsr-score-up"></s>',e}function c(a,e,t){a.data,a.affix;return e.data+='<s class="shopdsr-score-down"></s>',e}function p(a,e,t){a.data,a.affix;return e.data+='<s class="shopdsr-score-equal"></s>',e}function v(a,e,t){var r=a.data,s=a.affix;e.data+="";var n=(f=s.rate_UFB)!==t?f:(f=r.rate_UFB)!==t?f:a.resolveLooseUp(["rate_UFB"]),i=n;return i=2===n,e=_.call(m,a,{"params":[i],"fn":c,"inverse":p},e),e.data+="",e}function u(a,t,r){var i=a.data,l=a.affix;t.data+=' <div class="shopdsr-item"><div class="shopdsr-title"> ';var c=(f=l.xindex)!==r?f:(f=i.xindex)!==r?f:a.resolveLooseUp(["xindex"]),p=c;p=0===c,t=_.call(m,a,{"params":[p],"fn":e,"inverse":s},t),t.data+=' </div><div class="shopdsr-score ';var u=(f=l.rate_UFB)!==r?f:(f=i.rate_UFB)!==r?f:a.resolveLooseUp(["rate_UFB"]),h=u;h=0===u,t=_.call(m,a,{"params":[h],"fn":n,"inverse":o},t),t.data+='"><span class="shopdsr-score-con">';var g=(f=l.rate)!==r?f:(f=i.rate)!==r?f:a.resolveLooseUp(["rate"]);t=t.writeEscaped(g),t.data+="</span> ";var x=(f=l.rate_UFB)!==r?f:(f=i.rate_UFB)!==r?f:a.resolveLooseUp(["rate_UFB"]),b=x;return b=0===x,t=_.call(m,a,{"params":[b],"fn":d,"inverse":v},t),t.data+=" </div></div> ",t}var f,m=this,h=m.root,g=m.buffer,x=m.scope,b=(m.runtime,m.name,m.pos,x.data),w=x.affix,U=h.nativeCommands,L=h.utils,y=(L.callFn,L.callDataFn,L.callCommand,U.range,U["void"],U.foreach,U.forin,U.each),_=(U["with"],U["if"]);U.set,U.include,U.parse,U.extend,U.block,U.macro,U["debugger"];g.data+="";var E=(f=w.rates)!==a?f:(f=b.rates)!==a?f:x.resolveLooseUp(["rates"]);return g=y.call(m,x,{"params":[E],"fn":u},g),g.data+=' <a class="slogo-triangle"><i class="icon-triangle"></i></a>',g};return function(a){return(t=t||new e(r))&&t.render(a)||""}},{"requires":["kg/xtemplate/4.3.0/runtime"]});
KISSY.add("shop/head/shopinfo/dsr.tpl",function(a,e){var t,s=function(a){function e(a,e,t){a.data,a.affix;return e.data+="\u63cf\u8ff0\u76f8\u7b26\uff1a",e}function t(a,e,t){a.data,a.affix;return e.data+="\u670d\u52a1\u6001\u5ea6\uff1a",e}function s(a,e,t){a.data,a.affix;return e.data+="\u7269\u6d41\u670d\u52a1\uff1a",e}function r(a,e,t){var s=a.data,r=a.affix;return(f=r.isInternational)!==t?f:(f=s.isInternational)!==t?f:a.resolveLooseUp(["isInternational"])}function i(a,e,t){a.data,a.affix;return e.data+="\u8de8\u5883\u7269\u6d41\uff1a",e}function n(a,e,n){var l=a.data,o=a.affix;e.data+="";var d=(f=o.xindex)!==n?f:(f=l.xindex)!==n?f:a.resolveLooseUp(["xindex"]),c=d;return c=1===d,e=E.call(m,a,{"params":[c],"fn":t,"inverse":s,"elseIfs":[{"test":r,"fn":i}]},e),e.data+="",e}function l(a,e,t){a.data,a.affix;return e.data+=' <span class="no-rate" title="\u5c1a\u672a\u6536\u5230\u8bc4\u4ef7">--</span> ',e}function o(a,e,t){var s=a.data,r=a.affix;e.data+=' <span class="rateinfo" title="\u8ba1\u7b97\u89c4\u5219:(\u5e97\u94fa\u5f97\u5206-\u540c\u884c\u4e1a\u5e73\u5747\u5206)/(\u540c\u884c\u4e1a\u5e97\u94fa\u6700\u9ad8\u5f97\u5206-\u540c\u884c\u4e1a\u5e73\u5747\u5206)"><b></b> <i>\u9ad8\u4e8e</i> <em>';var i=(f=r.rate_g)!==t?f:(f=s.rate_g)!==t?f:a.resolveLooseUp(["rate_g"]);return e=e.writeEscaped(i),e.data+="%</em> </span> ",e}function d(a,e,t){var s=a.data,r=a.affix;e.data+=' <span class="rateinfo" title="\u8ba1\u7b97\u89c4\u5219:(\u540c\u884c\u4e1a\u5e73\u5747\u5206-\u5e97\u94fa\u5f97\u5206)/(\u540c\u884c\u4e1a\u5e73\u5747\u5206-\u540c\u884c\u4e1a\u5e97\u94fa\u6700\u4f4e\u5f97\u5206)"><b class="lower"></b> <i>\u4f4e\u4e8e</i> <em class="lower">';var i=(f=r.rate_g)!==t?f:(f=s.rate_g)!==t?f:a.resolveLooseUp(["rate_g"]);return e=e.writeEscaped(i),e.data+="%</em> </span> ",e}function c(a,e,t){a.data,a.affix;return e.data+=' <span class="rateinfo"><b class="fair"></b> <i>\u6301\u5e73</i> <em>--------</em> </span> ',e}function p(a,e,t){var s=a.data,r=a.affix;e.data+=" ";var i=(f=r.rate_UFB)!==t?f:(f=s.rate_UFB)!==t?f:a.resolveLooseUp(["rate_UFB"]),n=i;return n=2===i,e=E.call(m,a,{"params":[n],"fn":d,"inverse":c},e),e.data+=" ",e}function v(a,e,t){var s=a.data,r=a.affix;e.data+=' <em class="count" title="';var i=(f=r.rate_title)!==t?f:(f=s.rate_title)!==t?f:a.resolveLooseUp(["rate_title"]);e=e.writeEscaped(i),e.data+='">';var n=(f=r.rate)!==t?f:(f=s.rate)!==t?f:a.resolveLooseUp(["rate"]);e=e.writeEscaped(n),e.data+="</em> ";var l=(f=r.rate_UFB)!==t?f:(f=s.rate_UFB)!==t?f:a.resolveLooseUp(["rate_UFB"]),d=l;return d=0===l,e=E.call(m,a,{"params":[d],"fn":o,"inverse":p},e),e.data+=" ",e}function u(a,t,s){var r=a.data,i=a.affix;t.data+=" <li> ";var o=(f=i.xindex)!==s?f:(f=r.xindex)!==s?f:a.resolveLooseUp(["xindex"]),d=o;d=0===o,t=E.call(m,a,{"params":[d],"fn":e,"inverse":n},t),t.data+=' <a target="_blank" href="';var c=a.resolveLoose(["rate_link"],1);t=t.writeEscaped(c),t.data+='"> ';var p=(f=i.rate)!==s?f:(f=r.rate)!==s?f:a.resolveLooseUp(["rate"]),u=p;return u=0===p,t=E.call(m,a,{"params":[u],"fn":l,"inverse":v},t),t.data+=" </a></li> ",t}var f,m=this,h=m.root,g=m.buffer,x=m.scope,b=(m.runtime,m.name,m.pos,x.data),w=x.affix,L=h.nativeCommands,U=h.utils,y=(U.callFn,U.callDataFn,U.callCommand,L.range,L["void"],L.foreach,L.forin,L.each),E=(L["with"],L["if"]);L.set,L.include,L.parse,L.extend,L.block,L.macro,L["debugger"];g.data+='<h4>\u5e97\u94fa\u52a8\u6001\u8bc4\u5206<span class="compare">\u4e0e\u540c\u884c\u4e1a\u76f8\u6bd4</span></h4><ul class="render-byjs"> ';var k=(f=w.rates)!==a?f:(f=b.rates)!==a?f:x.resolveLooseUp(["rates"]);return g=y.call(m,x,{"params":[k],"fn":u},g),g.data+=" </ul>",g};return function(a){return(t=t||new e(s))&&t.render(a)||""}},{"requires":["kg/xtemplate/4.3.0/runtime"]});